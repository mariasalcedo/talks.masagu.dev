---
---
# Concurrent, but structured

<div style="display:inline-block;margin-top:50px;margin-left:50px;margin-right:50px;">
<span v-mark.circle.orange="2">
<img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjb3QQrxjQw6d5lCxlcuoDrVo9pCNEv3ICTt-7wZy26I2i8tvkfaNRNIs7067Cur0Sx8aVBlGhU83eR_0K6-HwXQOKMADag6wq7T6BzZhJow2taWkjon3vsUcgK3nINvtuH6vF2O8hbdZg/s800/dance_breakdance_thomas_flair.png" width="100"/>
</span></div>

<div style="display:inline-block;margin-left:50px;margin-right:100px;">
<img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjCmNwdQXDQs8maV4u1aIxJLi1TD3QnfMMEJMPsWYR0dGqinoA18nOq14Cv58j0j2_7Fx_pY5hWkcjAqK23Cbq53y9qgUJ-Qvt_xyV0E7zzjRnZfND4ASKDqY8QhvcYG8hNBgrU7mHZX049/s800/smartphone_girl_stand_smile.pngn" width="80"/> 
</div>

<div style="display:inline-block;margin-left:50px;margin-right:100px;">
<img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiolGywfabiOTNi-u4XEluOU1yqsD_Wkxp3d1B7UdKwjCIa2r2EBJ_YGXS1DchLHIlMGi0MVyMe6Rr5qz641mHs1Wrspz96ANQSWltp2uFZp7HQToBWlQTlg4irGwINo4IbPRbAOM9Adr_G/s1004/sagyouin_stand_smartphone_woman.png" width="50" /> 
</div>

<div style="display:inline-block;margin-left:50px;margin-right:50px;">
<span v-mark.circle.blue="3"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhjM4hoQeC9PlJv2Zgj-W65G6LdjFZvjzH7zIoLZjjUJU-wbBiF3MVhrYVLx7GhU_9y9TcYHiQcRoOQ1125cxGxz_uuuXWkjxpL5YQqV2Jm6g7XGeA164aaCHEfj0kbWi9WszV0kbs5JKvB/s800/sports_capoeira_man.png" width="100" /> 
</span></div>

<div style="display:inline-block;margin-left:50px;margin-right:100px;">
<img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjCmNwdQXDQs8maV4u1aIxJLi1TD3QnfMMEJMPsWYR0dGqinoA18nOq14Cv58j0j2_7Fx_pY5hWkcjAqK23Cbq53y9qgUJ-Qvt_xyV0E7zzjRnZfND4ASKDqY8QhvcYG8hNBgrU7mHZX049/s800/smartphone_girl_stand_smile.pngn" width="80"/> 
</div>

<div style="display:inline-block;margin-left:50px;margin-right:50px;">
<span v-mark.circle.orange="2"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh_Kg5SRLOw0R_V7e2wKx2m62pLDe15CuUpKBhpmzC4PRkHA-HGz3wMsY4VGCoiLuPmyh7s6wZSPSnxp2GrQbolHQ9Uu-lPXPYg1luEH1Wn3JLVVACjF53pCfXVFBdvFexeNgzgVKlDWqF5/s800/music_air_guitar.png" width="100"/>
</span></div>

<div style="display:inline-block;margin-left:50px;margin-right:50px;">
<span v-mark.circle.blue="3"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhjM4hoQeC9PlJv2Zgj-W65G6LdjFZvjzH7zIoLZjjUJU-wbBiF3MVhrYVLx7GhU_9y9TcYHiQcRoOQ1125cxGxz_uuuXWkjxpL5YQqV2Jm6g7XGeA164aaCHEfj0kbWi9WszV0kbs5JKvB/s800/sports_capoeira_man.png" width="100" /> 
</span></div>

<div style="display:inline-block;margin-left:50px;margin-right:50px;">
<img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg2OmuUmon0A2PrhwXAUI_xHMw3ZqaQ8APFia-NjpipPWhbZslK6KHbhjHtUIc_8KcWy0XEC3FVRMFbAw_MP-3Pg3jijZZny8mJ2GzcEXFDuRsQ_VPGDZcwtFTpLsee2-0vYi_NHsxA3TmY/s800/smartphone_schoolboy_stand.png" width="80"/> 
</div>

<div style="display:inline-block;margin-left:50px;margin-right:50px;">
<span v-mark.circle.orange="2"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhLWmGz9CCSpcA7OHjg_pikqolexw9tlCQ1TJz492ymi_cSxTNbznqsxI_WwO1ozbYB2ealv6VL7soEYEUCwUCIyyqGUC8x7l30Bdc3E_OJFZYLQZ0bx3XmzBhFMKyWm7lWG8hOBcB2tq7T/s800/dance_breakdance_windmill.png" width="100"/>
</span></div>

<div style="display:inline-block;margin-left:50px;margin-right:50px;">
<span v-mark.circle.blue="3"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhjM4hoQeC9PlJv2Zgj-W65G6LdjFZvjzH7zIoLZjjUJU-wbBiF3MVhrYVLx7GhU_9y9TcYHiQcRoOQ1125cxGxz_uuuXWkjxpL5YQqV2Jm6g7XGeA164aaCHEfj0kbWi9WszV0kbs5JKvB/s800/sports_capoeira_man.png" width="100" /> 
</span></div>


<div style="display:inline-block;margin-left:50px;margin-right:50px;">
<img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg_BltzFNEzwK7mficpTSpgFmn5YNSyyCqAwsVQOl1_D_wjYTnjZjP0ectr68bSwhEMpR9wv9ZPEp-sSUydg5xv5memtMatjYBFcZIZov9D3c0ZrXTNXjJgrLbUTBmj7nODmvkLWGh5K3-j/s800/smartphone_man_stand.png" width="80"/> 
</div>

<div style="display:inline-block;margin-left:50px;margin-right:50px;">
<img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjAeGNeOpV8DhSfyIY29t8yrzJZGO_rzNrBBQwlot4jtJ8Fuyy-eIfxLQ1ojuqg4RyFlurEH0fdu0P_JdHcIgvOx1vbast3ml7JDxlC2snHadlbZVyrHLM8mamGwAP3E86Y7KAT_VSnv8lj/s800/sleep_animal_cat.png" width="100" /> 
</div>

---
---
# Problematic #1
## java threads == OS/platform threads => limited & costly

<div style="display:inline-block;margin-left:50px;margin-right:50px;">
<img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiAMlN6d4lRuRRRuv7pGjuVW2KCdG2aGzYVSMyUuISgp0R9UEQMtigmNhOB5zvv28UuRvnb1_2OPVx9oyo0_vg7taf9L6_ZLlQBGp5uq0scNzc5nOyAshalLbwpsX-bfwzomPCeTNx1gHXs/s800/computer_server_chara1_normal.png" width="100">
</div>

<div style="display:inline-block;margin-right:50px;">
<img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjgjXr0iBmnvE79s3AxeQsmWnc41BArK-VeFo668bsTwkdsh9jTW3yzVKcZFMP7NJku9aRGXUGwXGVNDyrT0eOg3E0GIaToxEHpvFGNldKWkKhkZL_IXiQwwwPWxgjtfwu54u6kgrkOvHAk/s800/kinshi_pool_hashiru.png" width="100" style="transform: scaleX(-1);" />
</div>

<div style="display:inline-block;margin-top:100px;margin-right:50px;">
<img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiPjEZKnUb5Zfv6weHMWanGZ9nFbWuQP3cXKDcwKWBEuDc6WFCWAK_VJyuJ9NTHNgXk1gBC9GiAYjdLCZmSbymcWgX9AHYzqUikjZ9iIzivVsPBpeE4SdV06G8HlUELX8watBaKnK8Z6v8/s800/kids_pool.png" width="200" />
</div>

 <div style="display:inline-block;margin-right:50px;">
<img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgcGz7TpqCSxa-h0OFWGf1Kwo8J8x8MuAZpsFCI9mo51C3k4TB14PQEwgMcTK1H854_BfBuzXEZfXGH3rzjlg2QMqimDqc9q3wBTe7IfV8ZFEyaPUGBOPqeuq_4Hioe8zhEGlM45Jd4p9eb/s800/pool_run_kodomo.png" width="100" style="transform: scaleX(-1);" />
</div>

 <div style="display:inline-block;">
<img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgm7j4O9Fre9FhRX8tdlNhppCwhjAkoOPtG4s0-j8ClpkGFCix3cpZ9Kys7usPGEpOBmGGTZ70wgZSJEXKog8MP_BV0JJIHYEV9zPfjdJnOiWV2eWiCIZcMMP5-Wfyiv5r9caNxvFAm0Mg/s800/cafe_coffee_cup.png" width="100" />
</div>

---
layout: image-left
image: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj8OPJWZPe34aLTarcc_Hlwfa9H257Favpe0SQRZPExJayGqUilyi8YeuwltJZlkNS2CI6YM9iU2p_izJm9ZagvkbWyncvxKd4GvIuoLsi9T7GscmM89KCehy-R4HK6rWxz-w3STQuVTFk/s800/kao_oboerarenai_man.png"
---
# Problematic #2
## one async request, multiple stages

Stages running on interleaved threads => 
- no context, 
- hard to debug, 
- operation costs hard to trace

---
layout: fact
transition: fade-out
---

# What's next?  ðŸ¤”
### Solution: Virtual Threads
---
layout: intro-image-right
image: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg5R5-2ZzZ5Mm2DnHZsEuor-baOM7dq1EsHUJgrNXsRAEWs1V2s7KZP_jXW0jk4s6OfAeugOmDIisEQeau6WjUkfcOKWOGk9kc-_xR0bq47cSCZByJU8aKAk2MLaRQeG7q9tQ7_Yl-Cv2Q/s800/yukiyama_tozan.png"
transition: fade-out
---
# Virtual Threads: Motivations

- efficient thread-per-request: to enable higher concurrency needed for higher throughput
- asynchron-ability ~~madness~~ challenges

---
layout: intro-image-right
image: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjecENepAjLs-3tUGVZIlmWmazJ0NwrIDLiwLVCsjVIihd5oH0KAU-QcWeVqw8AenrsyhXvtpXU-kSCPByh3EODwIwQEKz7MCX0FlB0VMoRO25Zo5sCHpNKVZ0wYWadzf4Dkk0N9fdcqBrc/s1600/super_business_woman_bannou.png"
---
# Virtual Threads - Facts

- consumes OS thread <=> performs CPU calculations
- **Structured Concurrency** => context
- should not pool them
- To limit concurrency: `Semaphore`
- higher throughput <mdi-check-outline class="text-green-400" /> lower latency<mdi-close-outline class="text-red-400" />
- for a small number of OS threads, resources can be seen as unlimited <sup><sup>(But is an illusionâœ¨)</sup></sup>

---
---
# What Virtual Threads DOES NOT intend to implement <mdi-close-outline class="text-red-400" />

- to replace platform Threads
- to change the Streams API
- to migrate existing libraries to Virtual Threads


